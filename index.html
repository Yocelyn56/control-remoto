<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Control Remoto</title>

<style>
    body {
        margin: 0;
        min-height: 100vh;
        font-family: Arial, sans-serif;
        text-align: center;
        background:
            linear-gradient(rgba(255,255,255,0.75), rgba(255,255,255,0.75)),
            url("fondo.jpeg");
        background-size: cover;
        background-position: center;
    }

    h1 {
        margin-top: 20px;
        font-size: 38px; /* título un poco más grande */
        color: #222;
    }

    .seccion {
        background: rgba(255,255,255,0.95);
        width: 300px;
        margin: 20px auto;
        padding: 20px;
        border-radius: 14px;
        box-shadow: 0 6px 15px rgba(0,0,0,0.25);
    }

    button {
        width: 140px;
        padding: 12px;
        margin: 8px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        color: white;
    }

    /* BOTONES DE CONEXIÓN MÁS PEQUEÑOS */
    .conexion-btn {
        width: 110px;
        padding: 8px;
        font-size: 14px;
    }

    .bluetooth { background: #2196F3; }
    .wifi { background: #9C27B0; }
    .abrir { background: #4CAF50; }
    .cerrar { background: #F44336; }
    .motor { background: #FF9800; }
</style>
</head>

<body>

<h1>Control Remoto</h1>

<!-- BOTONES DE CONEXIÓN -->
<div class="seccion">
    <h3>Conexión</h3>
    <button class="bluetooth conexion-btn" onclick="conectarBluetooth()">Bluetooth</button>
    <button class="wifi conexion-btn" onclick="conectarWiFi()">WiFi</button>
</div>

<!-- COMPUERTA -->
<div class="seccion">
    <h3>Compuerta</h3>
    <button class="abrir" onclick="enviar('ABRIR')">Abrir</button>
    <button class="cerrar" onclick="enviar('CERRAR')">Cerrar</button>
</div>

<!-- MOTOR -->
<div class="seccion">
    <h3>Motor</h3>
    <button class="motor" onclick="enviar('DERECHA')">Derecha</button>
    <button class="motor" onclick="enviar('IZQUIERDA')">Izquierda</button>
</div>

<script>
let modo = "";

let device;
let characteristic;

const SERVICE_UUID = '12345678-1234-1234-1234-1234567890ab';
const CHARACTERISTIC_UUID = 'abcd1234-5678-90ab-cdef-1234567890ab';

async function conectarBluetooth() {
    try {
        device = await navigator.bluetooth.requestDevice({
            acceptAllDevices: true,
            optionalServices: [SERVICE_UUID]
        });

        const server = await device.gatt.connect();
        const service = await server.getPrimaryService(SERVICE_UUID);
        characteristic = await service.getCharacteristic(CHARACTERISTIC_UUID);

        modo = "bluetooth";
        alert("Conectado por Bluetooth");
    } catch (error) {
        alert("Error al conectar Bluetooth");
    }
}

const ESP32_IP = "http://192.168.100.2";

function conectarWiFi() {
    modo = "wifi";
    alert("Modo WiFi activado");
}

function enviar(comando) {
    if (modo === "bluetooth") {
        if (!characteristic) {
            alert("Bluetooth no conectado");
            return;
        }
        const encoder = new TextEncoder();
        characteristic.writeValue(encoder.encode(comando));

    } else if (modo === "wifi") {
        fetch(`${ESP32_IP}/${comando.toLowerCase()}`)
            .catch(() => alert("Error WiFi"));

    } else {
        alert("Selecciona Bluetooth o WiFi");
    }
}
</script>

</body>
</html>
